---
title: 快速上手
permalink: /guide/start/quick-start
categories:
  - 指南
tags:
  - 指南
---

如果您只是想简单了解一下 MaaPipelineEditor (MPE)，此页面将在几分钟内带你从零开始使用 MPE 复现 MaaFramework 官方文档（下称“MFW 文档”）的 [应用实例](https://maafw.xyz/docs/3.1-PipelineProtocol.html#%E5%9C%BA%E6%99%AF%E6%8F%8F%E8%BF%B0)（下称“实例”），在此过程中介绍 MPE 的主要功能。

如果您希望详细了解 MPE 的各项功能，请查看功能介绍。

::: tip
本教程不含如何使用 MaaFramework，**您需要在阅读前有一定框架基础**，此篇教程仅提供导出 Pipeline 之前的步骤，**请在自行初步尝试框架及 Pipeline 之后再使用 MPE 作为您的开发工具！**
:::

## 准备工作

1. 首先，您需要根据 MFW 文档 [开发思路](https://maafw.xyz/docs/1.1-QuickStarted.html#%E5%BC%80%E5%8F%91%E6%80%9D%E8%B7%AF) 或 MFW [教程视频](https://www.bilibili.com/video/BV1yr421E7MW) 配置好**开发环境**，若您已有开发环境可以跳过此步骤。
2. 打开 MPE [在线站点](https://yamaape.codax.site/MaaPipelineEditor)，一切就绪！

## 初识界面

进入站点后，您可以看到如下页面加载（点击图片可放大查看）：

![](/images/操作界面-标识.png)

在本章，各个模块的功能我们将在使用时简单讲解，更多细节请查看文档相关部分。

## 节点操作

### 添加节点

在左侧 `节点工具` 模块，我们可以点击相关节点模板快速添加，在鼠标悬停时会有信息提示。

不同的节点模板仅用于快速初始化不同字段组合，创建后可自行调整任意字段。

例如，在实例中，我们需要创建一个 `开始示例` 节点，此节点不包含任何识别与动作，我们可以点击空节点模板：

![](/images/guide/quick-start/创建节点.png)

这样，一个节点就会被添加至编辑区。

虽然空节点模板不含任何动作与识别，但仍然会将 `recognition: "DirectHit"` 与 `action: "DoNothing"` 渲染至操作区以做指示，此时若导出编译器会生成如下代码：

```json
{
  "新建节点1": {
    "recognition": {
      "type": "DirectHit",
      "param": {}
    },
    "action": {
      "type": "DoNothing",
      "param": {}
    }
  }
}
```

### 修改节点字段

在实例中，第二个节点为 `进入显示`，思路为识别到 `XXX` 后执行 `Click` 动作。

我们可以直接创建一个文本识别节点：

![](/images/guide/quick-start/文字识别节点.png)

当我们**已经选中一个节点**时，再次创建节点会**直接生成在已选节点的后方**，并**自动添加连接**。

当有**单独选中**的节点时，编辑区右上角会显示 `节点字段` 面板，我们可以在这里配置当前选中节点的字段键值：

![](/images/guide/quick-start/节点字段.png)

由于我们直接生成了一个 `OCR` 模板节点，相关字段已经被自动配置，在此节点上，我们仅需在 expected 字段中填写需要识别的文本即可，相关字段会同步显示在节点上。（此处 GIF 动图会丢失部分颜色，实际在编辑时会正常渲染字段灰底）

![](/images/guide/quick-start/编辑字段.gif)

此时，我们已经完成了 `进入显示` 节点的配置，编译器会将此节点转换成如下代码：

```json
{
  "新建节点2": {
    "recognition": {
      "type": "OCR",
      "param": {
        "expected": ["显示"]
      }
    },
    "action": {
      "type": "Click",
      "param": {}
    }
  }
}
```

### 修改节点名

虽然 Pipeline 协议仅规定不出现重复的键名即可，但我们一般期望其具有一定语义性。

我们可以修改节点字段的 `key` 值来配置节点名：

![](/images/guide/quick-start/修改节点名.png)

同样的，节点名会直接渲染在节点上以做提示，此时编译器则会将 `key` 值编译为节点的键值：

```json
{
  "进入显示": {
    "recognition": {
      /* ... */
    },
    "action": {
      /* ... */
    }
  }
}
```

### 添加字段

在实例中，`进入游戏二级菜单` 需要我们进行 `Swipe` 滑动操作，此动作一般需要配置 `begin` 与 `end` 两个值。

MPE 并没有提供滑动模板，我们可以从创建一个空模板开始完成相关配置。

首先，使用空模板添加节点。当我们**没有选中节点**时，节点会出现在**当前可视视口的最右侧**，默认添加后自动追焦视口至节点位于中心状态。

修改节点名称为 `进入游戏二级菜单`，并将 `action` 调整为 `Swipe`：

![](/images/guide/quick-start/修改关键字段.gif)

MPE 针对每种数据类型配置了不同的输入方式，在此处我们通过下拉框的方式选择了 `Swipe` 值

当切换 `recognition` 或 `action` 值时，节点字段面板会**自动筛选该字段可配置的值**，我们可是**使用右侧配置下拉选项添加字段**，也可**通过删除按键移除字段**：

![](/images/guide/quick-start/添加字段.gif)

在添加后，我们可以如常修改相应的值，您可以**将鼠标移动至字段名查看相关提示**：

![](/images/guide/quick-start/查看字段属性.png)

对于 `[x, y, w, h]` 类型字段，MPE 可接收一个标准数组，或将中括号省略，编译器会自动进行处理。

### 相关操作

我们将剩余节点配置完成：

![](/images/guide/quick-start/节点操作-练习.png)

在此过程中，您可以**直接拖拽节点调整其位置**，按住 `shift` 框选多个节点，**使用 `Ctrl + C/V` 快速复制粘贴节点**，**使用右下角排版工具对多个节点进行统一操作**，使用 `Delete` 或 `Backspace` 键删除节点。

您可以自行练习，也可以直接将以下代码通过 `导入(v2)` 功能快速与此教程同步：

![](/images/guide/quick-start/导入代码.gif)

::: details 点击查看代码

```json
{
  "__mpe_config_新建Pipeline1": {
    "__mpe_code": {
      "prefix": "",
      "filename": "新建Pipeline1",
      "version": "v0.5.0"
    }
  },
  "开始示例": {
    "recognition": {
      "type": "DirectHit",
      "param": {}
    },
    "action": {
      "type": "DoNothing",
      "param": {}
    },
    "__mpe_code": {
      "position": {
        "x": 1382,
        "y": 367
      }
    }
  },
  "进入显示": {
    "recognition": {
      "type": "OCR",
      "param": {
        "expected": ["显示"]
      }
    },
    "action": {
      "type": "Click",
      "param": {}
    },
    "__mpe_code": {
      "position": {
        "x": 1639,
        "y": 368
      }
    }
  },
  "进入游戏二级菜单": {
    "recognition": {
      "type": "DirectHit",
      "param": {}
    },
    "action": {
      "type": "Swipe",
      "param": {
        "begin": [0, 0, 0, 0],
        "end": [1, 2, 3, 4]
      }
    },
    "__mpe_code": {
      "position": {
        "x": 1934,
        "y": 455
      }
    }
  },
  "进入存储": {
    "recognition": {
      "type": "OCR",
      "param": {
        "expected": ["存储"]
      }
    },
    "action": {
      "type": "Click",
      "param": {}
    },
    "__mpe_code": {
      "position": {
        "x": 1638,
        "y": 539
      }
    }
  },
  "进入无障碍": {
    "recognition": {
      "type": "OCR",
      "param": {
        "expected": ["无障碍"]
      }
    },
    "action": {
      "type": "Click",
      "param": {}
    },
    "__mpe_code": {
      "position": {
        "x": 1637,
        "y": 710
      }
    }
  },
  "进入应用二级菜单": {
    "recognition": {
      "type": "DirectHit",
      "param": {}
    },
    "action": {
      "type": "DoNothing",
      "param": {}
    },
    "__mpe_code": {
      "position": {
        "x": 1936,
        "y": 659
      }
    }
  }
}
```

:::

## 连接操作

### 端点

每个常规节点包含四个端点，其含义分别如下图所示：

![](/images/guide/quick-start/出入口.png)

- 节点右侧的端点为出口，分别会被编译为 `next`、`interrupt`、`on_error` 字段。
- 节点左侧的端点为入口，接收任意出口连接。

每个出口端点可以连接任意数量的入口端点，每个入口端点可以连接任意数量的出口端点，直接拖拽端点进行连接操作：

![](/images/guide/quick-start/连接节点.gif)

### 标签

在每条连接中间会有数字标签，表示被编译为相应字段后在数组中的顺序，为创建连接的顺序，例如在本实例中上示操作会被编译为：

```json
{
  "开始示例": {
    /* ... */
    "next": ["进入显示", "进入存储", "进入无障碍"],
    "on_error": ["识别超时"]
  },
  "进入存储": {
    /* ... */
    "next": ["进入游戏二级菜单", "进入应用二级菜单"]
  }
}
```

您可以通过左上角设置按键配置隐藏连接标签。

### 相关操作

选中连接后，您可以使用 `Delete` 或 `Backspace` 键删除连接。

## 导出

瞧，您已经使用 MPE 编写了第一个 Pipeline 文件！

至此，我们已经完成了实例的业务逻辑，我们可以使用右侧 JSON 面板对当前流程图进行预览或导出。

当框选任意数量的节点时，面板会显示 `部分导出` 功能，仅会导出选中的节点与连接的 Pipeline JSON。

您也可以直接使用 `全部导出` 功能，此功能无视选中的节点，会直接导出当前文件所有节点与连接的 Pipeline JSON。

## 再次导入

复制需要导入的 Pipeline 文件**代码**（注意不是文件，是直接复制文件内的所有代码），点击 MPE 右侧 `Pipeline JSON` 面板的 `导入(v2)` 按钮，即可导入当前文件。

若您的项目中没有 v1 协议 Pipeline，您可以在设置中隐藏 `导入(v1)` 按钮以免点击错误，使用 v1 按钮导入 v2 文件时 MPE 并不会报错，但实际会解析错误。

## 接下来...

接下来，您可以自行体验 MPE 的其余功能，相关文档会在接下来的一段时间里不断补充，细节问题可先在 MaaFramework 集成/开发交流群（[595990173](https://qm.qq.com/q/gqSv6ukjV8)）中询问。

---
title: 概览与部署
permalink: /guide/server/deploy
categories:
  - 指南
tags:
  - 指南
---

本地服务允许 MaaPipelineEditor 与您本地的其他应用程序进行实时通信，实现双向通信。

MaaPipelineEditor 提供了 **LocalBridge (LB)** 作为官方本地服务，目前主要用于本地文件管理，您也可以 [自行集成](/guide/other/protocol)。

## 功能概览

LocalBridge 目前提供以下功能：

- ✅ **本地文件管理**：扫描、打开、保存、新建、实时监听 Pipeline 文件等
- ✅ **字段辅助**：实时截图、内容识别、颜色提取等
- 🚧 **流程级调试**：节点调试、断点续行等（开发中，**预计 12.22 前完成**）
- 🚀 **AI 辅助编辑**：智能搜索、节点补全、流程生成、MCP 支持等（开发中，**长期技术迭代**）

![loading...](/images/guide/lb/big-pie.png)

::: tip 参与建议
MPE LocalBridge 还在起步阶段。如果您对这些功能感兴趣或有其他建议，欢迎在 [GitHub Issues](https://github.com/kqcoxn/MaaPipelineEditor/issues) 中催更讨论！
:::

## 下载与安装

### 方式一：一键安装（推荐）

您可以在任意系统上使用一行指令下载并安装 LocalBridge：

::: code-group

```shell [Windows (PowerShell, 推荐)]
irm https://raw.githubusercontent.com/kqcoxn/MaaPipelineEditor/main/tools/install.ps1 | iex
```

```shell [Windows (CMD)]
curl -fsSL https://raw.githubusercontent.com/kqcoxn/MaaPipelineEditor/main/tools/install.bat -o %TEMP%\install-mpelb.bat && %TEMP%\install-mpelb.bat
```

```shell [Linux/macOS]
curl -fsSL https://raw.githubusercontent.com/kqcoxn/MaaPipelineEditor/main/tools/install.sh | bash
```

:::

::: tip 提示

- Windows CMD 方式需要系统自带 curl 工具，部分旧版本 Windows 需要先自行安装
- 安装完成后，您可以在全局使用 `mpelb` 命令启动服务
- LocalBridge 支持自动检测更新，启动时会提示最新版本并显示更新命令，请即时更新以同步协议
  :::

### 方式二：手动下载

您可以在 [GitHub Release](https://github.com/kqcoxn/MaaPipelineEditor/releases) 页面下载对应平台的 LocalBridge 可执行文件：

- Windows: `mpelb-windows-amd64.exe`
- Linux: `mpelb-linux-amd64`
- macOS: `mpelb-darwin-amd64/arm64`

下载后，您可以在可执行文件目录下通过命令行运行可执行文件，或添加环境变量后全局使用。

## 启动服务

### 快速启动

在您的 Pipeline 根目录下（推荐在 `Asstes` 文件夹路径），打开终端并运行：

```bash
mpelb
```

这将使用默认配置启动 LocalBridge：

- **扫描目录**：当前工作目录
- **服务端口**：9066
- **日志级别**：INFO
- **配置存储**：系统用户数据目录

启动成功后，您将看到类似输出：

```
[14:32:15][INFO][Main] Local Bridge 启动中... 版本: v0.10.0
[14:32:15][INFO][Main] 运行模式: 本地模式
[14:32:15][INFO][Main] 数据目录: C:\Users\YourName\AppData\Roaming\MaaPipelineEditor\LocalBridge
[14:32:15][INFO][Main] 运行目录: D:\my-pipelines
[14:32:15][INFO][WebSocket] WebSocket 服务已启动: ws://localhost:9066
[14:32:15][INFO][FileService] 初始扫描完成，发现 12 个文件
[14:32:15][INFO][FileWatcher] 文件监听器已启动
```

### 自定义配置（可选）

#### 指定扫描目录

如果您的 Pipeline 文件不在当前目录，可以指定根目录：

```bash
mpelb --root D:/my-pipelines
```

或者使用相对路径：

```bash
mpelb --root ./pipelines
```

#### 修改服务端口

如果默认端口 9066 被占用，可以指定其他端口：

```bash
mpelb --port 9999
```

::: warning 注意
修改端口后，需要在编辑器的配置面板中同步修改端口号
:::

#### 调整日志级别

调试时可以提高日志详细程度：

```bash
mpelb --log-level DEBUG
```

可选的日志级别：`DEBUG` | `INFO`（默认） | `WARN` | `ERROR`

#### 组合使用

您可以组合多个参数：

```bash
mpelb --root ./pipelines --port 9066 --log-level INFO --log-dir ./logs
```

### 使用配置文件

#### 配置管理命令

LocalBridge 提供了便捷的配置管理命令：

**打开配置文件**：

```bash
mpelb config open
```

该命令会使用系统默认编辑器打开配置文件。

**设置 MaaFramework 库路径**：

```bash
mpelb config set-lib [path]
```

- 不带参数：交互式选择或输入路径
- 带参数：直接设置指定路径

**设置 OCR 资源路径**：

```bash
mpelb config set-resource [path]
```

- 不带参数：交互式选择或输入路径
- 带参数：直接设置指定路径

**查看配置信息**：

```bash
mpelb info
```

显示当前运行模式、配置文件位置、日志目录等信息。

## 连接 Editor

### 连接与配置

在 MaaPipelineEditor 界面右上角,您会看到 LocalBridge 连接按钮:

- **未连接状态**:显示「未连接本地服务」,按钮为灰色
- **连接中状态**:显示「连接服务中...」,按钮禁用并显示加载图标
- **已连接状态**:显示「MPE LocalBridge」,按钮为蓝色

点击按钮即可连接或断开本地服务。

**后续，您可以在配置界面勾选自动连接功能，在打开 Editor 后会自动尝试连接到本地服务！**

### 配置端口

如果您修改了 LocalBridge 的启动端口,需要在前端进行相应配置:

1. 点击右上角的 **⚙️ 配置** 按钮打开配置面板
2. 在「本地通信」区域找到「端口」配置项
3. 输入您的自定义端口号（默认 9066）
4. 修改后需要重新点击连接按钮

::: tip 自动连接
在配置面板的「本地通信」区域,您可以开启「自动连接」选项,下次打开编辑器时会自动尝试连接本地服务
:::

## 断开连接

如果需要停止使用 LocalBridge:

1. 在配置面板中点击 **断开** 按钮
2. 或者直接关闭 LocalBridge 的终端窗口

::: warning 注意
LocalBridge 不会自动重连，断开后需要手动点击「连接」按钮重新建立连接
:::

## 常见问题

### MaaFramework 路径配置

如果启用了 MaaFramework 功能但未配置路径，启动时会提示：

```
未配置 MaaFramework lib 路径，请运行以下命令进行配置：
  mpelb config set-lib
```

按照提示运行配置命令，选择或输入 MaaFramework Release 包的 `bin` 目录即可。

### 自动更新检测

LocalBridge 启动时会自动检测新版本（开发版除外）。如果有新版本可用，会显示：

```
══════════════════════════════════════════════════
🎉 发现新版本
══════════════════════════════════════════════════
   当前版本: v0.9.0
   最新版本: v0.10.0

   下载地址:
   https://github.com/kqcoxn/MaaPipelineEditor/releases/tag/v0.10.0
   快速更新指令:
   irm https://raw.githubusercontent.com/kqcoxn/MaaPipelineEditor/main/tools/install.ps1 | iex
══════════════════════════════════════════════════
```

复制对应系统的更新命令即可快速更新到最新版本。

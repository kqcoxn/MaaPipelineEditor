---
title: 导入与导出
permalink: /guide/core/persistence
categories:
  - 指南
tags:
  - 指南
---

## 配置处理方案

MPE 提供了三种配置处理方案，您可以在配置面板中切换，以适应不同的使用场景：

### 集成导出

配置嵌入 Pipeline 文件中，适合单文件分享和简单场景。

- **导出行为**：配置信息（如节点位置、连接曲率等）直接保存在 Pipeline JSON 文件的 `__mpe_config__` 字段中
- **文件结构**：单个 `.json` 或 `.jsonc` 文件
- **适用场景**：
  - 持续使用 MPE 开发项目
  - 需要分享完整的可视化 Pipeline
  - 希望保持单文件整洁

### 分离导出

配置存储至独立的 `.mpe.json` 文件，便于版本管理和团队协作。

- **导出行为**：Pipeline 代码与配置分离保存
  - Pipeline 文件：`文件名.json` 或 `文件名.jsonc`（纯净的 Pipeline 代码）
  - 配置文件：`.文件名.mpe.json`（MPE 配置信息）
- **导出选项**：在导出对话框中可选择：
  - **导出 Pipeline 和配置**：同时导出两个文件
  - **仅导出 Pipeline**：只导出 Pipeline 代码文件
  - **仅导出配置**：只导出配置文件
- **适用场景**：
  - 需要优化版本控制
  - 团队协作开发
  - 保持 Pipeline 代码的纯净性
  - 配置文件可独立管理

::: tip 提示
分离模式下，配置文件以 `.` 开头，默认在文件浏览器中隐藏，MFW 在加载时也不会读取此文件，您可以放心调试。
:::

### 不导出

不保存任何配置信息，导入时触发自动布局。

- **导出行为**：只保存纯 Pipeline 代码，不包含任何 MPE 配置
- **导入行为**：MPE 会自动对节点进行布局排列
- **适用场景**：
  - 只需要 Pipeline 代码本身
  - 不关心可视化布局
  - 希望最小化文件内容

## 导出

### 导出到粘贴板

MPE 提供了便捷的粘贴板导出功能：

**部分导出**：

- 框选任意数量的节点
- 点击 `Pipeline JSON` 面板的 `部分至粘贴板` 按钮
- 仅导出选中的节点与连接

**全部导出**：

- 点击 `Pipeline JSON` 面板的对应按钮：
  - **集成/不导出模式**：显示 `全部至粘贴板` 按钮，导出完整内容
  - **分离模式**：显示 `导出 Pipeline` 和 `导出配置` 两个按钮，可分别导出

### 导出为文件

**使用本地服务导出**（推荐）：

1. 连接 MPE LocalBridge 本地服务
2. 在左侧文件面板中选择目标文件或点击保存按钮
3. 配置会根据设定的处理方案自动保存

**浏览器下载导出**：

1. 点击右上角导出按钮
2. 在弹出的导出对话框中：
   - 输入文件名
   - 选择格式（`.json` 或 `.jsonc`）
   - **分离模式特有**：选择导出目标（Pipeline、配置或两者）
3. 使用浏览器下载功能保存到本地

::: tip 格式说明

- `.json`：标准 JSON 格式
- `.jsonc`：支持注释的 JSON 格式，便于添加说明
  :::

## 导入

MPE 支持多种导入方式，会自动检测并兼容 v1 和 v2 协议格式。

### 从粘贴板导入

1. 复制 Pipeline 文件的**代码内容**（不是文件本身）
2. 点击 `Pipeline JSON` 面板的 `从粘贴板导入` 按钮
3. MPE 自动解析并加载内容

### 从文件导入

支持导入 `.json` 或 `.jsonc` 文件：

**方式一：本地服务导入**（推荐）

- 使用 MPE LocalBridge 快捷导入
- 自动关联配置文件（分离模式下）
- 详见 [本地服务文档](/guide/server/deploy.html)

**方式二：拖拽导入**

- 直接将文件拖拽到 MPE 页面的任意位置

**方式三：点击按钮导入**

- 点击 `Pipeline JSON` 面板的 `从文件导入` 按钮
- 选择需要导入的文件

### 导入兼容性

- ✅ 自动检测协议版本（v1/v2）
- ✅ 支持同一文件内混合使用不同协议的节点
- ✅ 支持导入空文件（自动解析为空 JSON）
- ✅ 自动识别配置处理方案：
  - 包含 `__mpe_config__` 字段：识别为集成模式
  - 检测到 `.mpe.json` 配置文件：识别为分离模式
  - 无配置信息：触发自动布局

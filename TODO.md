# 二、分阶段重构优化建议（按优先级）

## 优先级 P3：UI 结构与交互治理

- [ ] Header 主题切换按钮的样式优化（配合"白天黑夜按钮优化"偏好），但在工程侧应通过统一的主题切换 API/上下文，避免组件内部直接调用 `darkreader`。
- [ ] `ConfigPanel` 的"自动连接"逻辑保留，但把自动连接策略绑定至一个可取消的 effect 中，并暴露重试按钮，遵循"失败不自动重试"的偏好。

## 优先级 P5：测试与文档

### 引入 Vitest + React Testing Library

- [ ] stores 的单元测试（历史记录、选中态、粘贴板）；
- [ ] services 的契约测试（消息编解码、路由分派）。

### 文档完善

- [ ] docsite 补充"通信协议"与"本地服务运行方式"的最新约束（端口、超时、自动启动策略、前端状态指示），确保团队成员快速上手。
